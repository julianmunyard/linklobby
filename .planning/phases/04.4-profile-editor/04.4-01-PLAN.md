---
phase: 04.4-profile-editor
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/types/profile.ts
  - src/stores/profile-store.ts
autonomous: true

must_haves:
  truths:
    - "Profile state types are fully defined"
    - "Profile store provides reactive state management"
    - "Profile store tracks hasChanges for save/discard"
  artifacts:
    - path: "src/types/profile.ts"
      provides: "Profile and SocialIcon type definitions"
      exports: ["Profile", "SocialIcon", "SocialPlatform", "TitleStyle", "TitleSize", "ProfileLayout", "SOCIAL_PLATFORMS"]
    - path: "src/stores/profile-store.ts"
      provides: "Zustand store for profile state"
      exports: ["useProfileStore"]
  key_links:
    - from: "src/stores/profile-store.ts"
      to: "src/types/profile.ts"
      via: "imports types"
      pattern: "import.*from.*types/profile"
---

<objective>
Create profile type definitions and Zustand store for profile header state management.

Purpose: Establishes the data foundation for all profile editing features - types define the shape, store provides reactive state.
Output: profile.ts types and profile-store.ts with actions for all profile fields.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/04.4-profile-editor/04.4-CONTEXT.md
@.planning/phases/04.4-profile-editor/04.4-RESEARCH.md
@src/stores/page-store.ts
@src/types/card.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create profile type definitions</name>
  <files>src/types/profile.ts</files>
  <action>
Create profile type definitions:

1. Define `SocialPlatform` type: 'instagram' | 'tiktok' | 'youtube' | 'spotify' | 'twitter'

2. Define `SocialIcon` interface:
   - id: string
   - platform: SocialPlatform
   - url: string
   - sortKey: string (fractional indexing for ordering - same pattern as cards)

3. Define `SOCIAL_PLATFORMS` constant with metadata for each platform:
   - label: display name
   - icon: Lucide icon name (Instagram, Music2 for TikTok, Youtube, Music for Spotify, Twitter)
   - placeholder: example URL
   - enabled: boolean (all Big 5 = true)

4. Define `TitleStyle`: 'text' | 'logo'
5. Define `TitleSize`: 'small' | 'large'
6. Define `ProfileLayout`: 'classic' | 'hero'

7. Define `Profile` interface:
   - displayName: string | null
   - avatarUrl: string | null
   - titleStyle: TitleStyle
   - titleSize: TitleSize
   - logoUrl: string | null
   - profileLayout: ProfileLayout
   - showSocialIcons: boolean
   - socialIcons: SocialIcon[]

Export all types and constants.
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>All profile types exported, no TypeScript errors</done>
</task>

<task type="auto">
  <name>Task 2: Create profile Zustand store</name>
  <files>src/stores/profile-store.ts</files>
  <action>
Create Zustand store following page-store.ts patterns:

1. Import types from profile.ts
2. Import zustand create function and ordering utilities

3. Define `ProfileState` interface with:
   - All Profile fields as state
   - hasChanges: boolean
   - lastSavedAt: number | null

4. Define actions:
   - setDisplayName(name: string | null)
   - setAvatarUrl(url: string | null)
   - setTitleStyle(style: TitleStyle)
   - setTitleSize(size: TitleSize)
   - setLogoUrl(url: string | null)
   - setProfileLayout(layout: ProfileLayout)
   - setShowSocialIcons(show: boolean)
   - addSocialIcon(platform: SocialPlatform, url: string)
   - updateSocialIcon(id: string, url: string)
   - removeSocialIcon(id: string)
   - reorderSocialIcons(oldIndex: number, newIndex: number)
   - initializeProfile(profile: Partial<Profile>) - for loading from DB
   - markSaved()
   - getSnapshot() - returns current profile state

5. Set sensible defaults:
   - displayName: null
   - avatarUrl: null
   - titleStyle: 'text'
   - titleSize: 'large'
   - logoUrl: null
   - profileLayout: 'classic'
   - showSocialIcons: true
   - socialIcons: []

6. All mutations should set hasChanges: true

Note: Do NOT add temporal/undo middleware yet - profile is simpler than cards, defer if needed.
Use generateAppendKey, generateMoveKey from @/lib/ordering for social icon ordering.
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>Profile store exports useProfileStore, all actions work with proper typing</done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes with no errors
- Both files exist and export expected symbols
- Store can be imported in isolation: `import { useProfileStore } from '@/stores/profile-store'`
</verification>

<success_criteria>
- Profile types fully defined with all fields from CONTEXT.md
- Social platform metadata constant available
- Profile store provides reactive state for all profile fields
- Store follows existing page-store patterns (hasChanges, actions, getSnapshot)
</success_criteria>

<output>
After completion, create `.planning/phases/04.4-profile-editor/04.4-01-SUMMARY.md`
</output>
