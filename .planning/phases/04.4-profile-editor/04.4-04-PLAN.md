---
phase: 04.4-profile-editor
plan: 04
type: execute
wave: 2
depends_on: ["04.4-01", "04.4-02", "04.4-03"]
files_modified:
  - src/components/editor/design-tab.tsx
  - src/components/editor/header-section.tsx
  - src/components/editor/editor-panel.tsx
autonomous: true

must_haves:
  truths:
    - "Design tab shows Header section at top"
    - "Profile photo has circular preview with Edit button"
    - "Profile layout toggle shows Classic/Hero options"
    - "Title style toggle switches between Text and Logo"
    - "Title size picker shows Small/Large when title style is Text"
  artifacts:
    - path: "src/components/editor/design-tab.tsx"
      provides: "Design tab content wrapper"
      exports: ["DesignTab"]
    - path: "src/components/editor/header-section.tsx"
      provides: "Profile header editing section"
      exports: ["HeaderSection"]
  key_links:
    - from: "src/components/editor/editor-panel.tsx"
      to: "src/components/editor/design-tab.tsx"
      via: "imports DesignTab"
      pattern: "import.*DesignTab.*from.*design-tab"
    - from: "src/components/editor/design-tab.tsx"
      to: "src/components/editor/header-section.tsx"
      via: "imports HeaderSection"
      pattern: "import.*HeaderSection.*from.*header-section"
    - from: "src/components/editor/header-section.tsx"
      to: "src/stores/profile-store.ts"
      via: "uses useProfileStore"
      pattern: "useProfileStore"
---

<objective>
Create the Design tab with Header section for profile editing (photo, layout, title style/size).

Purpose: This is the main UI where artists edit their profile header - the Design tab replaces the empty state and HeaderSection contains all profile controls.
Output: Working profile editing UI with photo upload trigger, layout toggle, and title controls.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/04.4-profile-editor/04.4-CONTEXT.md
@.planning/phases/04.4-profile-editor/04.4-RESEARCH.md
@.planning/phases/04.4-profile-editor/04.4-01-SUMMARY.md
@.planning/phases/04.4-profile-editor/04.4-02-SUMMARY.md
@.planning/phases/04.4-profile-editor/04.4-03-SUMMARY.md
@src/components/editor/editor-panel.tsx
@src/stores/profile-store.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create DesignTab component</name>
  <files>src/components/editor/design-tab.tsx</files>
  <action>
Create DesignTab as the container for Design tab content:

1. Import HeaderSection (to be created)
2. Import ScrollArea from shadcn/ui for scrollable content

Component structure:
```tsx
"use client"

import { ScrollArea } from "@/components/ui/scroll-area"
import { HeaderSection } from "./header-section"

export function DesignTab() {
  return (
    <ScrollArea className="h-full">
      <div className="p-4 space-y-6">
        <HeaderSection />

        {/* Future sections: Theme, Background, etc. */}
      </div>
    </ScrollArea>
  )
}
```

Keep it simple - just a scrollable container that will hold multiple sections.
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>DesignTab component exports and contains HeaderSection</done>
</task>

<task type="auto">
  <name>Task 2: Create HeaderSection component</name>
  <files>src/components/editor/header-section.tsx</files>
  <action>
Create HeaderSection with all profile editing controls:

1. Imports:
   - useProfileStore
   - Profile types (TitleStyle, TitleSize, ProfileLayout)
   - UI components: Button, Input, Label, Switch, ToggleGroup
   - Camera, User icons from lucide-react
   - ImageCropDialog
   - uploadProfileImage from storage

2. Local state:
   - cropDialogOpen: boolean
   - selectedImage: string | null (data URL for cropping)
   - isUploading: boolean
   - imageType: 'avatar' | 'logo' (which image being edited)

3. Profile photo section:
   - Circle container (w-20 h-20 rounded-full)
   - Show avatar image or User icon placeholder
   - Edit button overlay
   - Click triggers file input
   - File input onChange: read file as data URL, open crop dialog

4. Profile layout toggle (Classic / Hero):
   - Use ToggleGroup with two items
   - Classic = small circle avatar
   - Hero = larger/banner style
   - Connect to profileStore.setProfileLayout

5. Title style toggle (Text / Logo):
   - Use ToggleGroup with two items
   - Connect to profileStore.setTitleStyle

6. Conditional rendering based on titleStyle:
   - If 'text': Show display name Input + title size picker (Small/Large ToggleGroup)
   - If 'logo': Show logo upload button/preview

7. Crop dialog integration:
   - When crop complete: upload to Supabase via uploadProfileImage
   - Update store with new URL (setAvatarUrl or setLogoUrl)
   - Clean up object URL after upload

8. Section styling:
   - Section title: "Header" with border-b
   - Sub-sections with labels: "Profile Photo", "Layout", "Title Style", etc.
   - Use consistent spacing (space-y-4 within sections)

Key implementation details:
- Use hidden file input triggered by button click
- Accept image/* only
- Show loading state during upload
- Handle errors with console.error (toast can be added later)
  </action>
  <verify>`npx tsc --noEmit` passes, component renders without errors</verify>
  <done>HeaderSection renders photo, layout toggle, title style toggle, conditional fields</done>
</task>

<task type="auto">
  <name>Task 3: Wire DesignTab into EditorPanel</name>
  <files>src/components/editor/editor-panel.tsx</files>
  <action>
Replace the Design tab empty state with DesignTab component:

1. Import DesignTab:
```typescript
import { DesignTab } from "./design-tab"
```

2. Find the TabsContent for "design" tab and replace the EmptyState with DesignTab:

Before:
```tsx
<TabsContent value="design" ...>
  <EmptyState
    icon={<Palette className="h-8 w-8 text-muted-foreground" />}
    title="Customize your design"
    description="Choose colors, fonts, and backgrounds to match your brand and style."
  />
</TabsContent>
```

After:
```tsx
<TabsContent value="design" ...>
  <DesignTab />
</TabsContent>
```

3. Keep the EmptyState function defined (it may be used elsewhere or for future tabs).

4. Ensure TabsContent has correct overflow classes for scrolling within DesignTab.
  </action>
  <verify>`npm run dev` - navigate to Design tab, HeaderSection visible</verify>
  <done>Design tab shows HeaderSection instead of empty state</done>
</task>

</tasks>

<verification>
- `npm run build` passes
- Design tab renders HeaderSection
- Profile photo shows circle with Edit overlay
- Layout and Title style toggles are interactive
- Title size picker appears when title style is "Text"
</verification>

<success_criteria>
- Design tab no longer shows empty state
- HeaderSection displays all profile editing controls
- Photo upload opens crop dialog
- Layout toggle switches between Classic/Hero
- Title style toggle switches between Text/Logo
- Display name input visible when title style is Text
</success_criteria>

<output>
After completion, create `.planning/phases/04.4-profile-editor/04.4-04-SUMMARY.md`
</output>
