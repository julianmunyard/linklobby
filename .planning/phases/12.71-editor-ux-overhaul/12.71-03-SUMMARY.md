---
phase: 12.71-editor-ux-overhaul
plan: 03
subsystem: ui
tags: [react, cards, rendering, typography, line-breaks]

# Dependency graph
requires:
  - phase: 12.71-editor-ux-overhaul
    provides: card component infrastructure
provides:
  - renderWithLineBreaks utility in src/lib/render-utils.tsx
  - Newline-to-<br /> rendering in text-card, link-card, horizontal-link, hero-card, square-card
affects: [any future card type additions, public page rendering]

# Tech tracking
tech-stack:
  added: []
  patterns: [renderWithLineBreaks utility pattern for safe newline rendering in JSX]

key-files:
  created:
    - src/lib/render-utils.tsx
  modified:
    - src/components/cards/text-card.tsx
    - src/components/cards/link-card.tsx
    - src/components/cards/horizontal-link.tsx
    - src/components/cards/hero-card.tsx
    - src/components/cards/square-card.tsx

key-decisions:
  - "Use .tsx extension for render-utils since it contains JSX (Fragment, br)"
  - "Use Fragment key={i} wrapper (not span) to avoid extra DOM elements"
  - "square-card uses card.title || '' fallback — TypeScript requires string not string|null even though showTitle guard ensures title is truthy"
  - "Did NOT apply renderWithLineBreaks to link-card title — title already has line-clamp-2 and description is the user-editable multiline field"

patterns-established:
  - "renderWithLineBreaks: import from @/lib/render-utils for any component displaying user-entered text that may contain newlines"

# Metrics
duration: 8min
completed: 2026-02-26
---

# Phase 12.71 Plan 03: Line Break Rendering Summary

**renderWithLineBreaks utility (Fragment + br split) applied to all 5 card types — titles and descriptions now render \n as visible line breaks on both editor preview and public page**

## Performance

- **Duration:** 8 min
- **Started:** 2026-02-26T00:00:00Z
- **Completed:** 2026-02-26T00:08:00Z
- **Tasks:** 1
- **Files modified:** 6

## Accomplishments
- Created `renderWithLineBreaks` utility that splits on `\n` and wraps each line in a Fragment with a `<br />` between lines
- Applied to text-card (title + description), link-card (description), horizontal-link (description), hero-card (title + description), square-card (title)
- No regression — editor textarea inputs are not touched; only rendering side modified
- Build TypeScript check passes (0 new errors)

## Task Commits

Each task was committed atomically:

1. **Task 1: Create renderWithLineBreaks utility and apply to all card types** - `cc6a1db` (feat)

**Plan metadata:** (see below)

## Files Created/Modified
- `src/lib/render-utils.tsx` - renderWithLineBreaks utility using React Fragment + br
- `src/components/cards/text-card.tsx` - title and description use renderWithLineBreaks
- `src/components/cards/link-card.tsx` - description uses renderWithLineBreaks
- `src/components/cards/horizontal-link.tsx` - description uses renderWithLineBreaks
- `src/components/cards/hero-card.tsx` - title and description use renderWithLineBreaks
- `src/components/cards/square-card.tsx` - title uses renderWithLineBreaks

## Decisions Made
- Used `.tsx` extension for render-utils (not `.ts`) because the function returns JSX — TypeScript requires this
- Used `Fragment` wrapper instead of `span` to avoid extra DOM elements that could affect CSS styling
- For square-card, added `|| ""` fallback since `card.title` is `string | null` in the type system, even though `showTitle` already guards for truthiness above
- Did not apply to link-card's title — link cards have `line-clamp-2` on title and the description is the natural multiline field for artists

## Deviations from Plan

None - plan executed exactly as written. Minor TypeScript fix (null safety on square-card title) was a natural type-system correctness issue, not a deviation.

## Issues Encountered
- `card.title` typed as `string | null` in the Card type caused a TypeScript error in square-card where the guard (`showTitle = Boolean(card.title)`) is above but TypeScript can't narrow through it. Fixed with `card.title || ""` fallback — safe since `showTitle` is false when title is null.

## User Setup Required
None - no external service configuration required.

## Next Phase Readiness
- Line break rendering complete and consistent across all card types
- renderWithLineBreaks utility available at @/lib/render-utils for any future card type additions
- No blockers for Plan 04

---
*Phase: 12.71-editor-ux-overhaul*
*Completed: 2026-02-26*
