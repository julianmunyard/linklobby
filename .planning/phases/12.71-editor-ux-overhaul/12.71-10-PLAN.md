---
phase: 12.71-editor-ux-overhaul
plan: 10
type: execute
wave: 3
depends_on: []
files_modified:
  - src/components/cards/gallery-card.tsx
  - src/components/editor/gallery-card-fields.tsx
  - src/components/cards/image-upload.tsx
autonomous: true

must_haves:
  truths:
    - "Gallery carousel photos fill the frame edge-to-edge"
    - "Photo cards show crop icon instead of pencil icon"
    - "User can crop/reposition photos directly on the card preview"
  artifacts:
    - path: "src/components/cards/gallery-card.tsx"
      provides: "Gallery card with edge-to-edge photos"
    - path: "src/components/cards/image-upload.tsx"
      provides: "Photo card with crop icon and in-preview crop"
  key_links:
    - from: "src/components/cards/image-upload.tsx"
      to: "src/lib/image-compression.ts"
      via: "crop result compression"
      pattern: "compressImageForUpload"
---

<objective>
Fix gallery carousel photo framing and add in-preview photo crop.

Purpose: Gallery carousel photos have side gaps instead of filling the frame edge-to-edge. Photo cards need a more intuitive crop experience — replace the pencil icon with a crop icon and allow drag/pinch repositioning directly on the card.

Output: Edge-to-edge gallery photos and in-preview photo crop interaction.
</objective>

<execution_context>
@/Users/julianmunyard/.claude/get-shit-done/workflows/execute-plan.md
@/Users/julianmunyard/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/12.71-editor-ux-overhaul/12.71-RESEARCH.md

Key files to reference:
@src/components/cards/gallery-card.tsx (gallery carousel rendering)
@src/components/cards/image-upload.tsx (photo upload with pencil icon)
@src/components/editor/gallery-card-fields.tsx (gallery editor)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix gallery carousel edge-to-edge and replace pencil with crop icon</name>
  <files>
    src/components/cards/gallery-card.tsx
    src/components/cards/image-upload.tsx
  </files>
  <action>
1. In `src/components/cards/gallery-card.tsx`:
   - Find the carousel/image rendering section
   - Identify what's causing side gaps — likely padding on the container, or the image not using `object-cover` with `w-full h-full`
   - Fix: Ensure images use `w-full h-full object-cover` and the container has no horizontal padding
   - The carousel container should have `overflow-hidden` and no side margins
   - If using a carousel library, check if it adds default padding/margins between slides
   - Images should fill the entire card width edge-to-edge

2. In `src/components/cards/image-upload.tsx` (or wherever the pencil edit icon appears on photo cards):
   - Replace the Pencil icon with the Crop icon from lucide-react: `import { Crop } from 'lucide-react'`
   - The icon should appear as an overlay on the image card when hovered (editor only, not public page)
   - Keep the same click behavior (opens the existing ImageCropDialog from react-easy-crop)

3. For in-preview photo crop (item 16 — drag/pinch to reposition):
   - When the crop icon is clicked in the editor preview, open the existing `ImageCropDialog` component (already built with react-easy-crop)
   - If the current UX opens a modal dialog, that's acceptable for now — true inline drag-to-crop on the card itself would require significant refactoring of the card rendering
   - Enhancement: Add a quick-position feature — after crop dialog closes, the image `object-position` is updated to reflect the crop area center. Store this as `imagePosition: { x: number, y: number }` in card content.
   - If `object-position` is already supported in card content, wire it up. If not, add it to the card content type and apply it in the image rendering style.

4. IMPORTANT: These changes should work on both flow and scatter mode layouts. Test that gallery card in scatter mode also shows edge-to-edge photos.
  </action>
  <verify>
    - `npm run build` passes
    - Gallery carousel shows photos edge-to-edge (no side gaps)
    - Crop icon visible on photo cards in editor (not pencil)
    - Clicking crop icon opens crop dialog
    - Crop result updates the card image
  </verify>
  <done>
    - Gallery carousel photos fill frame edge-to-edge
    - Pencil icon replaced with Crop icon
    - Crop dialog accessible from preview
    - Image positioning stored in card content
  </done>
</task>

</tasks>

<verification>
- `npm run build` completes with 0 TypeScript errors
- Gallery carousel: no side gaps, photos fill frame
- Crop icon on photo cards
- Crop dialog works from preview
</verification>

<success_criteria>
- Gallery photos edge-to-edge
- Crop icon replaces pencil
- In-preview crop works via existing crop dialog
- Build passes clean
</success_criteria>

<output>
After completion, create `.planning/phases/12.71-editor-ux-overhaul/12.71-10-SUMMARY.md`
</output>
