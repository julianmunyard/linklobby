---
phase: 12.1-scatter-mode
plan: 05
type: execute
wave: 4
depends_on: ["12.1-03", "12.1-04"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Complete scatter mode workflow verified end-to-end"
    - "All 10 success criteria from phase CONTEXT.md verified"
  artifacts: []
  key_links: []
---

<objective>
Verify the complete scatter mode feature end-to-end across editor and public pages.

Purpose: Scatter mode involves complex interactions (drag, resize, z-index, percentage conversion, theme switching, public page rendering, visitor drag). Human verification ensures the full workflow works as intended.
Output: Verified feature ready for use.
</objective>

<execution_context>
@/Users/julianmunyard/.claude/get-shit-done/workflows/execute-plan.md
@/Users/julianmunyard/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12.1-scatter-mode/12.1-CONTEXT.md
@.planning/phases/12.1-scatter-mode/12.1-03-SUMMARY.md
@.planning/phases/12.1-scatter-mode/12.1-04-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run build and type check</name>
  <files></files>
  <action>
Run the following commands to verify the project compiles and builds:

1. `npx tsc --noEmit` - TypeScript compilation check
2. `npm run build` - Full Next.js build to verify no SSR/import issues

Fix any compilation or build errors. Common issues to watch for:
- Missing imports for ScatterCanvas or StaticScatterCanvas
- react-rnd not properly installed
- "use client" boundary issues with server components importing client components
- Dynamic import issues if VisitorDragCanvas uses "use client"
  </action>
  <verify>Both `npx tsc --noEmit` and `npm run build` succeed without errors.</verify>
  <done>Project compiles and builds successfully with all scatter mode components.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete scatter mode system:
1. Scatter mode toggle in Style Controls (for 5 themes)
2. Freeform drag and resize of cards using react-rnd
3. Z-index management (last moved on top)
4. Per-theme scatter layout storage (percentages)
5. Public page scatter rendering
6. Optional visitor drag on public pages
7. Grid overlay in editor preview
  </what-built>
  <how-to-verify>
Run `npm run dev` and test the following scenarios:

**Editor - Basic Scatter Mode:**
1. Open the editor, select a scatter theme (e.g., Instagram Reels or Mac OS)
2. Go to Style tab -> verify "Freeform Layout" toggle is visible
3. Enable the toggle -> cards should switch from flow layout to scattered absolute positioning
4. Verify a subtle 12x12 grid overlay appears on the canvas
5. Try dragging a card -> it should move freely to any position
6. Try resizing a card from corners and edges -> it should resize freely
7. Drag a card on top of another -> the dragged card should be on top (z-index)
8. Cards should NOT be draggable beyond the canvas edges (bounds constraint)
9. Disable scatter mode -> cards should return to normal flow layout

**Editor - Theme Switching:**
10. Enable scatter mode on one theme and arrange cards
11. Switch to a different scatter theme -> scatter positions should be independent
12. Switch to a non-scatter theme (e.g., iPod Classic) -> flow layout, no scatter toggle visible
13. Switch back to the first scatter theme -> original layout should be preserved

**Editor - Per-Theme Persistence:**
14. Arrange cards in scatter mode, save the page
15. Refresh the browser -> scatter layout should be preserved
16. Verify positions are percentage-based: resize the browser window, layout should scale proportionally

**Public Page - Static Render:**
17. Publish the page with scatter mode enabled
18. Visit the public page -> cards should appear in the exact scatter positions from editor

**Public Page - Visitor Drag (if toggle was enabled):**
19. Enable visitor drag toggle in editor
20. Visit public page -> try clicking a card link -> should follow the link normally
21. Try holding and moving a card -> should drag the card
22. Refresh the page -> all visitor-moved cards should reset to original positions

**Non-Scatter Themes:**
23. Switch to iPod Classic, VCR, Receipt, Departures Board -> verify NO scatter toggle in Style Controls
24. Verify all existing theme layouts still work correctly

**Mobile:**
25. Test scatter drag on mobile preview (touch drag should work)
26. Verify touch-action doesn't conflict with page scroll outside scatter area

Type "approved" if all checks pass, or describe any issues found.
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues</resume-signal>
</task>

</tasks>

<verification>
All 10 success criteria from Phase 12.1 CONTEXT.md verified:
1. Scatter mode toggle for 5 themes
2. Free drag anywhere on canvas
3. Free resize from corners/edges
4. Z-index: last moved on top
5. Cards constrained within canvas bounds
6. Positions stored as percentages, per-theme
7. Public page renders exact layout
8. Optional visitor drag (resets on refresh)
9. Mobile-first with proportional scaling
10. Click vs drag distinction
</verification>

<success_criteria>
- TypeScript compilation and Next.js build pass
- All scatter mode features work in editor
- All scatter mode features work on public pages
- Non-scatter themes completely unaffected
- Mobile touch interactions work correctly
- Human tester approves the complete workflow
</success_criteria>

<output>
After completion, create `.planning/phases/12.1-scatter-mode/12.1-05-SUMMARY.md`
</output>
