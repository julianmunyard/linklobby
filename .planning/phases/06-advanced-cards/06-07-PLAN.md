---
phase: 06-advanced-cards
plan: 07
type: execute
wave: 2
depends_on: ["06-02"]
files_modified:
  - src/components/cards/game-card.tsx
  - src/components/cards/card-renderer.tsx
autonomous: true

must_haves:
  truths:
    - "Game card renders with retro arcade aesthetic"
    - "Game card shows demo/preview mode when not playing"
    - "Click/tap starts game play"
    - "Game over shows Play Again button"
  artifacts:
    - path: "src/components/cards/game-card.tsx"
      provides: "GameCard wrapper component"
      exports: ["GameCard"]
      min_lines: 80
    - path: "src/components/cards/card-renderer.tsx"
      provides: "Game case in switch"
      contains: "case \"game\""
  key_links:
    - from: "src/components/cards/game-card.tsx"
      to: "src/types/card.ts"
      via: "GameCardContent import"
      pattern: "GameCardContent|isGameContent"
---

<objective>
Create the Game Card wrapper component that hosts individual game implementations.

Purpose: Provides the shell for all three games with shared UI (play button, game over screen) and game state management.
Output: GameCard component integrated into card-renderer.tsx.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/06-advanced-cards/06-CONTEXT.md
@.planning/phases/06-advanced-cards/06-RESEARCH.md
@.planning/phases/06-advanced-cards/06-02-SUMMARY.md
@src/types/card.ts
@src/components/cards/card-renderer.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create GameCard Wrapper Component</name>
  <files>src/components/cards/game-card.tsx</files>
  <action>
Create src/components/cards/game-card.tsx:

```typescript
"use client"

import { useState, useEffect } from "react"
import { Play, RotateCcw } from "lucide-react"
import { cn } from "@/lib/utils"
import { Button } from "@/components/ui/button"
import type { Card, GameCardContent, GameType } from "@/types/card"
import { isGameContent, GAME_TYPE_INFO } from "@/types/card"

// Placeholder for game components - will be implemented in subsequent plans
function GamePlaceholder({ gameType }: { gameType: GameType }) {
  return (
    <div className="flex items-center justify-center h-full text-white/50">
      {GAME_TYPE_INFO[gameType]?.label || gameType} (Coming Soon)
    </div>
  )
}

type GameState = "idle" | "playing" | "gameOver"

interface GameCardProps {
  card: Card
  isPreview?: boolean
  isEditing?: boolean  // True when in editor (show static preview only)
}

export function GameCard({ card, isPreview = false, isEditing = false }: GameCardProps) {
  const [gameState, setGameState] = useState<GameState>("idle")
  const [score, setScore] = useState(0)

  const content = isGameContent(card.content)
    ? card.content
    : { gameType: "snake" as GameType }

  const gameType = content.gameType || "snake"
  const gameInfo = GAME_TYPE_INFO[gameType]

  // Reset game state when card changes
  useEffect(() => {
    setGameState("idle")
    setScore(0)
  }, [card.id, gameType])

  const handleStartGame = () => {
    if (isEditing) return // Don't allow gameplay in editor
    setGameState("playing")
    setScore(0)
  }

  const handleGameOver = (finalScore: number) => {
    setScore(finalScore)
    setGameState("gameOver")
  }

  const handlePlayAgain = () => {
    setGameState("playing")
    setScore(0)
  }

  // Fixed retro arcade aesthetic (doesn't adapt to theme)
  const arcadeStyle = cn(
    "relative w-full overflow-hidden rounded-lg",
    "bg-black border-2 border-[#00ff00]/30",
    // Aspect ratio based on card size
    card.size === "small" ? "aspect-square" : "aspect-video"
  )

  // In editor: always show static preview
  if (isEditing) {
    return (
      <div className={arcadeStyle}>
        <div className="absolute inset-0 flex flex-col items-center justify-center">
          {/* Animated demo preview - placeholder for now */}
          <div className="text-[#00ff00] font-mono text-center">
            <p className="text-lg font-bold">{gameInfo?.label}</p>
            <p className="text-xs text-[#00ff00]/60 mt-1">Preview Mode</p>
          </div>
          {/* Scanline effect */}
          <div className="absolute inset-0 pointer-events-none bg-gradient-to-b from-transparent via-[#00ff00]/5 to-transparent animate-pulse" />
        </div>
      </div>
    )
  }

  return (
    <div className={arcadeStyle}>
      {/* Idle state - show demo with play button */}
      {gameState === "idle" && (
        <div className="absolute inset-0 flex flex-col items-center justify-center">
          {/* Animated demo preview */}
          <div className="absolute inset-0 opacity-30">
            <GamePlaceholder gameType={gameType} />
          </div>
          {/* Play button overlay */}
          <Button
            onClick={handleStartGame}
            className="z-10 bg-[#00ff00]/20 hover:bg-[#00ff00]/40 text-[#00ff00] border border-[#00ff00]/50"
            size={card.size === "small" ? "sm" : "default"}
          >
            <Play className="h-4 w-4 mr-2" />
            Play {gameInfo?.label}
          </Button>
        </div>
      )}

      {/* Playing state - render actual game */}
      {gameState === "playing" && (
        <div className="absolute inset-0">
          {/* Game components will be conditionally rendered here */}
          <GamePlaceholder gameType={gameType} />
          {/* Score display */}
          <div className="absolute top-2 left-2 text-[#00ff00] font-mono text-xs">
            Score: {score}
          </div>
        </div>
      )}

      {/* Game over state */}
      {gameState === "gameOver" && (
        <div className="absolute inset-0 flex flex-col items-center justify-center bg-black/80">
          <div className="text-center">
            <p className="text-[#ff0000] font-mono text-xl font-bold">
              GAME OVER
            </p>
            <p className="text-[#00ff00] font-mono text-lg mt-2">
              Score: {score}
            </p>
            <Button
              onClick={handlePlayAgain}
              className="mt-4 bg-[#00ff00]/20 hover:bg-[#00ff00]/40 text-[#00ff00] border border-[#00ff00]/50"
              size="sm"
            >
              <RotateCcw className="h-4 w-4 mr-2" />
              Play Again
            </Button>
          </div>
        </div>
      )}

      {/* CRT scanline effect overlay */}
      <div
        className="absolute inset-0 pointer-events-none"
        style={{
          background: "repeating-linear-gradient(0deg, rgba(0,0,0,0.1) 0px, rgba(0,0,0,0.1) 1px, transparent 1px, transparent 2px)",
        }}
      />
    </div>
  )
}
```

Key features:
- Fixed retro arcade aesthetic (black bg, green accents, scanlines)
- Three states: idle (demo), playing, gameOver
- Play button to start, Play Again to restart
- Score display during play
- isEditing prop shows static preview in editor
- Adapts aspect ratio to card size
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>GameCard wrapper component created with state management</done>
</task>

<task type="auto">
  <name>Task 2: Integrate GameCard into CardRenderer</name>
  <files>src/components/cards/card-renderer.tsx</files>
  <action>
Update card-renderer.tsx to render GameCard:

1. Import GameCard:
```typescript
import { GameCard } from "./game-card"
```

2. Add case for game in switch statement:
```typescript
case "game":
  return <GameCard card={card} isPreview={isPreview} />
```

Note: The isEditing prop will be passed by editor components later. For preview mode, games are fully interactive.
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>CardRenderer handles game card type</done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes
- GameCard component exists and exports correctly
- CardRenderer has game case
- Game states (idle, playing, gameOver) work correctly
</verification>

<success_criteria>
- Game card renders with retro arcade look
- Idle state shows demo preview with Play button
- Playing state shows game area with score
- Game over state shows score and Play Again
- Editor mode shows static preview only
</success_criteria>

<output>
After completion, create `.planning/phases/06-advanced-cards/06-07-SUMMARY.md`
</output>
