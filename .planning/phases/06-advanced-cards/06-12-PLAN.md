---
phase: 06-advanced-cards
plan: 12
type: execute
wave: 3
depends_on: ["06-02", "06-07"]
files_modified:
  - src/components/editor/game-card-fields.tsx
  - src/components/editor/card-property-editor.tsx
  - src/components/editor/cards-tab.tsx
  - src/stores/page-store.ts
autonomous: true

must_haves:
  truths:
    - "Game card can be added from card picker"
    - "Game type is selectable (Snake, Breakout, Flappy)"
    - "Game card defaults to Snake"
  artifacts:
    - path: "src/components/editor/game-card-fields.tsx"
      provides: "GameCardFields component"
      exports: ["GameCardFields"]
    - path: "src/components/editor/cards-tab.tsx"
      provides: "Game option in add card menu"
      contains: "game"
  key_links:
    - from: "src/components/editor/card-property-editor.tsx"
      to: "src/components/editor/game-card-fields.tsx"
      via: "GameCardFields import"
      pattern: "GameCardFields"
---

<objective>
Add game card to editor with game type selection.

Purpose: Allows artists to add game cards and choose which game to display.
Output: Game in card picker, game type selector in property editor.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/06-advanced-cards/06-CONTEXT.md
@.planning/phases/06-advanced-cards/06-02-SUMMARY.md
@.planning/phases/06-advanced-cards/06-07-SUMMARY.md
@src/components/editor/card-property-editor.tsx
@src/components/editor/cards-tab.tsx
@src/stores/page-store.ts
@src/types/card.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create GameCardFields Component</name>
  <files>src/components/editor/game-card-fields.tsx</files>
  <action>
Create src/components/editor/game-card-fields.tsx:

```typescript
"use client"

import { Label } from "@/components/ui/label"
import { Button } from "@/components/ui/button"
import { cn } from "@/lib/utils"
import type { GameCardContent, GameType } from "@/types/card"
import { GAME_TYPE_INFO } from "@/types/card"

// Icons for each game type (simple SVG or emoji representations)
const GAME_ICONS: Record<GameType, string> = {
  snake: "üêç",
  breakout: "üß±",
  flappy: "üê¶",
}

interface GameCardFieldsProps {
  content: Partial<GameCardContent>
  onChange: (updates: Record<string, unknown>) => void
}

export function GameCardFields({ content, onChange }: GameCardFieldsProps) {
  const currentGame = content.gameType || "snake"

  const gameTypes: GameType[] = ["snake", "breakout", "flappy"]

  return (
    <div className="space-y-4">
      {/* Game Type Selector */}
      <div className="space-y-2">
        <Label>Game Type</Label>
        <div className="grid grid-cols-3 gap-2">
          {gameTypes.map((gameType) => {
            const info = GAME_TYPE_INFO[gameType]
            const isSelected = currentGame === gameType
            return (
              <Button
                key={gameType}
                type="button"
                variant="outline"
                className={cn(
                  "flex flex-col items-center gap-1 h-auto py-3",
                  isSelected && "border-primary bg-primary/10"
                )}
                onClick={() => onChange({ gameType })}
              >
                <span className="text-2xl">{GAME_ICONS[gameType]}</span>
                <span className="text-xs">{info.label}</span>
              </Button>
            )
          })}
        </div>
      </div>

      {/* Game Description */}
      <div className="p-3 bg-muted rounded-lg">
        <p className="text-sm font-medium">{GAME_TYPE_INFO[currentGame].label}</p>
        <p className="text-xs text-muted-foreground mt-1">
          {GAME_TYPE_INFO[currentGame].description}
        </p>
      </div>

      {/* Control Info */}
      <div className="text-xs text-muted-foreground space-y-1">
        <p className="font-medium">Controls:</p>
        {currentGame === "snake" && (
          <>
            <p>Desktop: Arrow keys or WASD</p>
            <p>Mobile: Swipe to change direction</p>
          </>
        )}
        {currentGame === "breakout" && (
          <>
            <p>Desktop: Move mouse to control paddle</p>
            <p>Mobile: Touch and drag to move paddle</p>
          </>
        )}
        {currentGame === "flappy" && (
          <>
            <p>Desktop: Click to flap</p>
            <p>Mobile: Tap to flap</p>
          </>
        )}
      </div>

      {/* Note about aesthetics */}
      <p className="text-xs text-muted-foreground italic">
        Games use a fixed retro arcade aesthetic and don't adapt to your page theme.
      </p>
    </div>
  )
}
```

Key features:
- Visual game type selector with icons
- Game descriptions from GAME_TYPE_INFO
- Control instructions per game
- Note about fixed aesthetic
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>GameCardFields component created</done>
</task>

<task type="auto">
  <name>Task 2: Add Game to Cards Tab and Update Store Defaults</name>
  <files>src/components/editor/cards-tab.tsx, src/stores/page-store.ts</files>
  <action>
Update cards-tab.tsx to include game in the add card menu:

1. Add game option with appropriate icon:
```typescript
{ type: "game" as CardType, icon: Gamepad2, label: "Game" }
```

2. Import Gamepad2 from lucide-react.

Update page-store.ts addCard function to handle game default content:

In the defaultContent switch statement, add:
```typescript
case 'game':
  return { gameType: 'snake' as GameType }
```

And for dropdown:
```typescript
case 'dropdown':
  return { childCardIds: [] }
```

Import GameType from types/card.ts.
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>Game option added to card picker, store defaults set</done>
</task>

<task type="auto">
  <name>Task 3: Integrate GameCardFields into Property Editor</name>
  <files>src/components/editor/card-property-editor.tsx</files>
  <action>
Update card-property-editor.tsx to render GameCardFields:

1. Import GameCardFields:
```typescript
import { GameCardFields } from "./game-card-fields"
```

2. Import GameCardContent type if not already imported

3. Add conditional render for game type:
```typescript
{card.card_type === "game" && (
  <GameCardFields
    content={currentContent as Partial<GameCardContent>}
    onChange={handleContentChange}
  />
)}
```

4. Game cards don't need:
   - Image upload (already excluded via CARD_TYPES_NO_IMAGE - need to add 'game' if not there)
   - Card type picker (game is not convertible)
   - URL field (no link on game cards)
   - Description field (optional - could hide)
   - Text/vertical alignment (doesn't apply)

5. Make sure 'game' is in CARD_TYPES_NO_IMAGE in types/card.ts (check and add if missing).

Game cards DO support:
   - Size selection (big/small)
   - Title (optional, for accessibility/context)
  </action>
  <verify>TypeScript compiles: `npx tsc --noEmit`</verify>
  <done>GameCardFields integrated into property editor</done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes
- Game appears in card picker
- Clicking game creates game card with snake default
- Game property editor shows game type selector
- Changing game type updates the card
</verification>

<success_criteria>
- Artist can add game from card picker
- Game type is selectable with visual buttons
- Default is Snake
- Control instructions display per game type
- Fixed aesthetic note is visible
</success_criteria>

<output>
After completion, create `.planning/phases/06-advanced-cards/06-12-SUMMARY.md`
</output>
