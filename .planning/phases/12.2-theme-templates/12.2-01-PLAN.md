---
phase: 12.2-theme-templates
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/templates/types.ts
  - src/lib/templates/index.ts
  - src/lib/templates/data/instagram-reels/dark-minimal.ts
autonomous: true

must_haves:
  truths:
    - "TemplateDefinition type captures cards, theme, profile, and media asset references"
    - "getTemplatesByTheme(themeId) returns templates filtered by theme"
    - "At least one placeholder template exists with realistic card data"
  artifacts:
    - path: "src/lib/templates/types.ts"
      provides: "TemplateDefinition, TemplateCard, TemplateTheme, TemplateProfile types"
      exports: ["TemplateDefinition", "TemplateCard", "TemplateTheme", "TemplateProfile"]
    - path: "src/lib/templates/index.ts"
      provides: "Template registry with getTemplatesByTheme and getTemplate helpers"
      exports: ["getTemplatesByTheme", "getTemplate", "getAllTemplates"]
    - path: "src/lib/templates/data/instagram-reels/dark-minimal.ts"
      provides: "First real template definition for instagram-reels theme"
      exports: ["instagramReelsDarkMinimal"]
  key_links:
    - from: "src/lib/templates/types.ts"
      to: "src/types/card.ts"
      via: "TemplateCard extends Omit<Card, ...>"
      pattern: "Omit<Card"
    - from: "src/lib/templates/types.ts"
      to: "src/types/theme.ts"
      via: "TemplateTheme uses ThemeState"
      pattern: "ThemeState"
    - from: "src/lib/templates/index.ts"
      to: "src/lib/templates/data/"
      via: "imports all template data files"
      pattern: "import.*from.*data/"
---

<objective>
Create the template type system and data infrastructure for theme templates.

Purpose: Establish the strongly-typed data format that all templates follow, the registry for looking up templates by theme, and one real placeholder template to validate the schema works end-to-end.
Output: Template types, registry module, and one instagram-reels template with realistic card data.
</objective>

<execution_context>
@/Users/julianmunyard/.claude/get-shit-done/workflows/execute-plan.md
@/Users/julianmunyard/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/12.2-theme-templates/12.2-RESEARCH.md
@src/types/card.ts
@src/types/theme.ts
@src/types/profile.ts
@src/types/audio.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create template type definitions</name>
  <files>src/lib/templates/types.ts</files>
  <action>
Create `src/lib/templates/types.ts` with these types:

1. **TemplateCard** — `Omit<Card, 'id' | 'page_id' | 'created_at' | 'updated_at'>`. This is the card shape stored in templates, without DB-generated fields. Media fields (imageUrl, storagePath, audioUrl) use relative paths like `/templates/{template-id}/hero.jpg` that get replaced on apply.

2. **TemplateTheme** — `Omit<ThemeState, 'pixels'>`. Full theme state minus pixel tracking config. Import ThemeState from `@/types/theme`.

3. **TemplateProfile** — `Partial<Pick<Profile, 'profileLayout' | 'showAvatar' | 'showTitle' | 'titleSize' | 'showSocialIcons' | 'showLogo' | 'headerTextColor' | 'socialIconColor'>>`. Never include avatarUrl or logoUrl — profile photos are always user-supplied.

4. **TemplateDefinition** — The top-level type:
   ```typescript
   export interface TemplateDefinition {
     id: string                      // e.g., 'instagram-reels-dark-minimal'
     themeId: string                 // Matches ThemeId for grouping
     name: string                    // Display name
     description: string             // Short blurb for picker
     energyLabel?: string            // e.g., 'hip-hop', 'indie folk'
     thumbnailPath: string           // '/templates/{id}/thumbnail.jpg'
     cards: TemplateCard[]
     theme: TemplateTheme
     profile: TemplateProfile
     mediaAssets: string[]           // Relative filenames that need upload on apply
   }
   ```

Import Card from `@/types/card`, ThemeState from `@/types/theme`, Profile from `@/types/profile`. Use the existing type system — do NOT redefine card/theme/profile types.

Note: ThemeState may not have a `pixels` field — check the actual type definition. If `pixels` doesn't exist on ThemeState, use ThemeState directly for TemplateTheme (or pick the fields that make sense to exclude).
  </action>
  <verify>Run `npx tsc --noEmit` — no type errors in the new file.</verify>
  <done>TemplateDefinition, TemplateCard, TemplateTheme, TemplateProfile exported from src/lib/templates/types.ts with correct imports from existing type system.</done>
</task>

<task type="auto">
  <name>Task 2: Create template registry and first template</name>
  <files>src/lib/templates/index.ts, src/lib/templates/data/instagram-reels/dark-minimal.ts</files>
  <action>
**Step 1: Create the first template file** at `src/lib/templates/data/instagram-reels/dark-minimal.ts`.

This should be a realistic instagram-reels template with:
- id: `'instagram-reels-dark-minimal'`
- themeId: `'instagram-reels'`
- name: `'Dark Minimal'`
- description: `'Clean dark aesthetic with bold typography'`
- energyLabel: `'minimal'`
- thumbnailPath: `'/templates/instagram-reels-dark-minimal/thumbnail.jpg'`
- 4-5 cards representing a realistic artist page:
  - A hero card (big) with title "YOUR NAME", description "Artist / Producer", url for a streaming link, imageUrl pointing to `/templates/instagram-reels-dark-minimal/hero.jpg`
  - A horizontal link card for "Latest Release" with a streaming URL
  - A horizontal link card for "Tour Dates"
  - A music card for an embedded Spotify link
  - A social-icons card (the social icons card type)
- Theme state matching instagram-reels defaults (look at the theme config for instagram-reels in the codebase to get the right colors/fonts/style)
- Profile defaults: `{ profileLayout: 'classic', showAvatar: true, showTitle: true, showSocialIcons: true }`
- mediaAssets: `['hero.jpg']` (the hero card image)

Use fractional-indexing sort keys for card ordering: `'a0'`, `'a1'`, `'a2'`, `'a3'`, `'a4'`.

Export the template as a named const: `export const instagramReelsDarkMinimal: TemplateDefinition = { ... }`

**Step 2: Create the template registry** at `src/lib/templates/index.ts`:

```typescript
import type { TemplateDefinition } from './types'
import type { ThemeId } from '@/types/theme'
import { instagramReelsDarkMinimal } from './data/instagram-reels/dark-minimal'

const ALL_TEMPLATES: TemplateDefinition[] = [
  instagramReelsDarkMinimal,
]

export function getAllTemplates(): TemplateDefinition[] {
  return ALL_TEMPLATES
}

export function getTemplatesByTheme(themeId: ThemeId): TemplateDefinition[] {
  return ALL_TEMPLATES.filter(t => t.themeId === themeId)
}

export function getTemplate(id: string): TemplateDefinition | undefined {
  return ALL_TEMPLATES.find(t => t.id === id)
}
```

Also re-export types: `export type { TemplateDefinition, TemplateCard, TemplateTheme, TemplateProfile } from './types'`
  </action>
  <verify>Run `npx tsc --noEmit` — no type errors. Verify `getTemplatesByTheme('instagram-reels')` would return 1 template and `getTemplatesByTheme('mac-os')` would return 0.</verify>
  <done>Template registry exports getAllTemplates, getTemplatesByTheme, getTemplate. One instagram-reels template exists with realistic card data, theme state, and profile defaults. TypeScript compiles cleanly.</done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes with zero errors
- Template types correctly reference existing Card, ThemeState, Profile types
- Registry functions are importable and type-safe
</verification>

<success_criteria>
- TemplateDefinition type fully captures cards + theme + profile + media references
- At least one template exists with realistic data
- Registry functions filter by themeId correctly
- All types compile without errors
</success_criteria>

<output>
After completion, create `.planning/phases/12.2-theme-templates/12.2-01-SUMMARY.md`
</output>
