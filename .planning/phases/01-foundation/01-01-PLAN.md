---
phase: 01-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - src/lib/supabase/client.ts
  - src/lib/supabase/server.ts
  - src/lib/supabase/middleware.ts
  - src/lib/utils.ts
  - src/app/layout.tsx
  - src/app/page.tsx
  - .env.local
  - postcss.config.mjs
autonomous: true

must_haves:
  truths:
    - "Next.js project runs with `npm run dev`"
    - "Tailwind CSS v4 styles are applied"
    - "shadcn/ui components are available"
    - "Supabase clients can be imported without errors"
  artifacts:
    - path: "package.json"
      provides: "Project dependencies"
      contains: "@supabase/ssr"
    - path: "src/lib/supabase/client.ts"
      provides: "Browser Supabase client"
      exports: ["createClient"]
    - path: "src/lib/supabase/server.ts"
      provides: "Server Supabase client"
      exports: ["createClient"]
    - path: "src/lib/supabase/middleware.ts"
      provides: "Session refresh helper"
      exports: ["updateSession"]
    - path: "src/lib/utils.ts"
      provides: "cn() class merge helper"
      exports: ["cn"]
  key_links:
    - from: "src/lib/supabase/client.ts"
      to: "process.env.NEXT_PUBLIC_SUPABASE_*"
      via: "environment variables"
      pattern: "NEXT_PUBLIC_SUPABASE"
    - from: "src/lib/supabase/server.ts"
      to: "next/headers cookies()"
      via: "cookie access"
      pattern: "cookies\\(\\)"
---

<objective>
Initialize the LinkLobby Next.js project with all foundational dependencies and Supabase client configuration.

Purpose: Establish the project scaffold that all subsequent phases build upon. This is the base layer.
Output: Working Next.js 16 project with TypeScript, Tailwind v4, shadcn/ui, and configured Supabase clients.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Next.js project and install dependencies</name>
  <files>
    - package.json
    - postcss.config.mjs
    - src/app/globals.css
  </files>
  <action>
Create Next.js project in the LinkLobby directory:

```bash
cd /Users/julianmunyard/LinkLobby
npx create-next-app@latest . --yes --app --src-dir --typescript --tailwind --eslint
```

After project creation, upgrade to Tailwind v4 and install all dependencies:

```bash
npm install tailwindcss@4 @tailwindcss/postcss postcss
npm install @supabase/supabase-js @supabase/ssr
npm install react-hook-form zod @hookform/resolvers
npm install clsx tailwind-merge lucide-react
```

Initialize shadcn/ui (accept defaults, use New York style, zinc base color):

```bash
npx shadcn@latest init -y
```

Add required shadcn components:

```bash
npx shadcn@latest add button input label card form toast
```

Update `postcss.config.mjs` for Tailwind v4:

```javascript
export default {
  plugins: {
    '@tailwindcss/postcss': {},
  },
}
```

Update `src/app/globals.css` for Tailwind v4 (replace entire contents):

```css
@import "tailwindcss";
```

Delete `tailwind.config.ts` if it exists (Tailwind v4 uses CSS-native config).

IMPORTANT: Do NOT use `@supabase/auth-helpers-nextjs` - it is deprecated. Use `@supabase/ssr` only.
  </action>
  <verify>
```bash
npm run dev
# Should start without errors
# Visit http://localhost:3000 - should show Next.js default page
```
  </verify>
  <done>
Project runs with `npm run dev`, all dependencies installed, Tailwind v4 configured.
  </done>
</task>

<task type="auto">
  <name>Task 2: Configure Supabase clients and utilities</name>
  <files>
    - src/lib/supabase/client.ts
    - src/lib/supabase/server.ts
    - src/lib/supabase/middleware.ts
    - src/lib/utils.ts
    - .env.local
  </files>
  <action>
Create `.env.local` with placeholder values:

```bash
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
```

Create `src/lib/utils.ts` (cn helper for class merging):

```typescript
import { type ClassValue, clsx } from 'clsx'
import { twMerge } from 'tailwind-merge'

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}
```

Create `src/lib/supabase/client.ts` (browser client):

```typescript
import { createBrowserClient } from '@supabase/ssr'

export function createClient() {
  return createBrowserClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!
  )
}
```

Create `src/lib/supabase/server.ts` (server client):

```typescript
import { createServerClient } from '@supabase/ssr'
import { cookies } from 'next/headers'

export async function createClient() {
  const cookieStore = await cookies()

  return createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        getAll() {
          return cookieStore.getAll()
        },
        setAll(cookiesToSet) {
          try {
            cookiesToSet.forEach(({ name, value, options }) =>
              cookieStore.set(name, value, options)
            )
          } catch {
            // Called from Server Component - ignored if middleware handles refresh
          }
        },
      },
    }
  )
}
```

Create `src/lib/supabase/middleware.ts` (session refresh helper):

```typescript
import { createServerClient } from '@supabase/ssr'
import { NextResponse, type NextRequest } from 'next/server'

export async function updateSession(request: NextRequest) {
  let supabaseResponse = NextResponse.next({ request })

  const supabase = createServerClient(
    process.env.NEXT_PUBLIC_SUPABASE_URL!,
    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,
    {
      cookies: {
        getAll() {
          return request.cookies.getAll()
        },
        setAll(cookiesToSet) {
          cookiesToSet.forEach(({ name, value }) =>
            request.cookies.set(name, value)
          )
          supabaseResponse = NextResponse.next({ request })
          cookiesToSet.forEach(({ name, value, options }) =>
            supabaseResponse.cookies.set(name, value, options)
          )
        },
      },
    }
  )

  // IMPORTANT: getUser() validates the JWT with Supabase Auth server
  // Do NOT use getSession() in server code - it doesn't validate the token
  const { data: { user } } = await supabase.auth.getUser()

  return { supabaseResponse, user }
}
```

CRITICAL: Always use `getUser()` in server code, never `getSession()`. The research doc emphasizes this is a security requirement.
  </action>
  <verify>
```bash
# Check files exist and TypeScript compiles
npx tsc --noEmit
# Should complete without type errors
```
  </verify>
  <done>
All Supabase client files created, utils.ts has cn() helper, .env.local has placeholders, TypeScript compiles without errors.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create minimal landing page and app structure</name>
  <files>
    - src/app/layout.tsx
    - src/app/page.tsx
    - src/app/(auth)/layout.tsx
    - src/app/(auth)/login/page.tsx
    - src/app/(auth)/signup/page.tsx
    - src/app/(dashboard)/layout.tsx
    - src/app/(dashboard)/editor/page.tsx
  </files>
  <action>
Update `src/app/layout.tsx`:

```typescript
import type { Metadata } from 'next'
import { Inter } from 'next/font/google'
import './globals.css'

const inter = Inter({ subsets: ['latin'] })

export const metadata: Metadata = {
  title: 'LinkLobby',
  description: 'Your link-in-bio, reimagined for artists',
}

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="en" className="dark">
      <body className={`${inter.className} bg-background text-foreground antialiased`}>
        {children}
      </body>
    </html>
  )
}
```

Update `src/app/page.tsx` (minimal landing):

```typescript
import Link from 'next/link'
import { Button } from '@/components/ui/button'

export default function Home() {
  return (
    <main className="flex min-h-screen flex-col items-center justify-center p-4">
      <h1 className="text-4xl font-bold mb-4">LinkLobby</h1>
      <p className="text-muted-foreground mb-8">Your link-in-bio, reimagined for artists</p>
      <div className="flex gap-4">
        <Button asChild>
          <Link href="/signup">Get Started</Link>
        </Button>
        <Button variant="outline" asChild>
          <Link href="/login">Log In</Link>
        </Button>
      </div>
    </main>
  )
}
```

Create `src/app/(auth)/layout.tsx`:

```typescript
export default function AuthLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <div className="flex min-h-screen items-center justify-center p-4">
      <div className="w-full max-w-md">
        {children}
      </div>
    </div>
  )
}
```

Create `src/app/(auth)/login/page.tsx` (placeholder):

```typescript
export default function LoginPage() {
  return (
    <div className="text-center">
      <h1 className="text-2xl font-bold mb-4">Log In</h1>
      <p className="text-muted-foreground">Login form coming in Plan 03</p>
    </div>
  )
}
```

Create `src/app/(auth)/signup/page.tsx` (placeholder):

```typescript
export default function SignupPage() {
  return (
    <div className="text-center">
      <h1 className="text-2xl font-bold mb-4">Sign Up</h1>
      <p className="text-muted-foreground">Signup form coming in Plan 03</p>
    </div>
  )
}
```

Create `src/app/(dashboard)/layout.tsx`:

```typescript
export default function DashboardLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <div className="min-h-screen">
      {children}
    </div>
  )
}
```

Create `src/app/(dashboard)/editor/page.tsx` (placeholder):

```typescript
export default function EditorPage() {
  return (
    <div className="flex min-h-screen items-center justify-center">
      <h1 className="text-2xl font-bold">Dashboard Editor</h1>
      <p className="text-muted-foreground">Coming in Phase 2</p>
    </div>
  )
}
```

This establishes the route group structure for auth pages and protected dashboard pages.
  </action>
  <verify>
```bash
npm run dev
# Visit http://localhost:3000 - should show landing page with styled buttons
# Visit http://localhost:3000/login - should show placeholder
# Visit http://localhost:3000/signup - should show placeholder
# Visit http://localhost:3000/editor - should show placeholder
```
  </verify>
  <done>
Route structure established with (auth) and (dashboard) route groups. Landing page shows shadcn/ui Button components with proper dark mode styling. All routes accessible.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. `npm run dev` starts without errors
2. http://localhost:3000 shows styled landing page
3. http://localhost:3000/login shows auth layout placeholder
4. http://localhost:3000/signup shows auth layout placeholder
5. http://localhost:3000/editor shows dashboard placeholder
6. `npx tsc --noEmit` passes with no type errors
7. Supabase client files exist at src/lib/supabase/*.ts
</verification>

<success_criteria>
- Next.js 16 project running with TypeScript
- Tailwind v4 configured (CSS-native, no tailwind.config.ts)
- shadcn/ui components available (Button, Input, Label, Card, Form, Toast)
- Supabase clients configured (browser + server + middleware helper)
- Route groups established for auth and dashboard
- Environment variables templated
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
